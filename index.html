<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>OPUS MACHINA // ORACLE V5.1</title>
    <style>
        :root {
            --amber: #ffb000;
            --amber-bright: #ffcc55;
            --amber-dim: #443000;
            --bg: #050505;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            background-color: var(--bg);
            color: var(--amber);
            font-family: 'Courier New', Courier, monospace;
            height: 100vh;
            margin: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        body::before {
            content: " "; display: block; position: absolute;
            top: 0; left: 0; bottom: 0; right: 0;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.2) 50%);
            z-index: 100; background-size: 100% 3px; pointer-events: none;
        }

        #ui-wrapper {
            position: relative; z-index: 10;
            display: flex; flex-direction: column;
            align-items: center; width: 100%; padding: 20px;
        }

        header {
            font-weight: bold; font-size: 1.1rem; letter-spacing: 3px;
            border-bottom: 2px solid var(--amber); padding-bottom: 8px; margin-bottom: 4vh;
        }

        .altar-grid {
            display: grid;
            grid-template-areas: ". ar ." "agua vela terra" ". fogo .";
            gap: clamp(15px, 5vw, 40px);
            align-items: center; justify-items: center;
        }

        .node {
            width: clamp(80px, 20vw, 110px); height: clamp(80px, 20vw, 110px);
            background: rgba(20, 15, 0, 0.9); border: 1.5px solid var(--amber);
            color: var(--amber); cursor: pointer;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
        }

        .node.active { background: var(--amber); color: #000; box-shadow: 0 0 20px var(--amber); }

        .symbol { width: 0; height: 0; border-left: 10px solid transparent; border-right: 10px solid transparent; margin-bottom: 5px; }
        .fogo .symbol { border-bottom: 18px solid var(--amber); }
        .ar .symbol { border-bottom: 18px solid var(--amber); position: relative; }
        .ar .symbol::after { content:''; position:absolute; top:10px; left:-10px; width:20px; height:2px; background:var(--amber); }
        .agua .symbol { border-top: 18px solid var(--amber); }
        .terra .symbol { border-top: 18px solid var(--amber); position: relative; }
        .terra .symbol::after { content:''; position:absolute; top:-12px; left:-10px; width:20px; height:2px; background:var(--amber); }

        .vela-container { grid-area: vela; display: flex; flex-direction: column; align-items: center; }
        .candle-base { width: 20px; height: 45px; border: 2px solid var(--amber); position: relative; }
        .flame {
            width: 14px; height: 24px; background: var(--amber-bright);
            border-radius: 50% 50% 35% 35%; margin-bottom: 4px;
            filter: blur(2px); opacity: 0; transition: opacity 0.5s;
        }
        .active .flame { opacity: 1; animation: flicker 0.1s infinite alternate; }

        #status-log {
            margin-top: 4vh; font-size: 0.8rem; color: #fff;
            border: 1px solid var(--amber-dim); padding: 12px;
            width: 90vw; max-width: 400px; text-align: center;
            background: rgba(20, 10, 0, 0.8); min-height: 60px;
        }

        #divine-btn {
            display: none; margin-top: 20px;
            background: transparent; color: var(--amber);
            border: 1px solid var(--amber); padding: 12px 24px;
            font-family: inherit; font-weight: bold;
            cursor: pointer; letter-spacing: 2px;
        }

        /* MODAL E INTERFACE DE DIVINAÇÃO */
        #card-modal {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.98); z-index: 200;
            flex-direction: column; align-items: center; justify-content: center;
            padding: 20px; text-align: center;
        }

        #ritual-steps {
            color: var(--amber); font-size: 1rem;
            max-width: 80vw;
        }

        #mentalize-timer {
            width: 250px; height: 1px;
            background: var(--amber-dim);
            margin: 30px auto; position: relative;
            overflow: hidden;
        }

        #timer-bar {
            width: 100%; height: 100%;
            background: var(--amber-bright);
            transform: translateX(-100%);
        }

        .card-display {
            display: none; border: 2px solid var(--amber); padding: 30px;
            max-width: 350px; background: #0a0a0a;
            box-shadow: 0 0 30px var(--amber-dim);
            animation: glitch-in 0.3s ease;
        }

        .card-title { font-size: 1.6rem; margin: 15px 0; color: var(--amber); border-bottom: 1px solid var(--amber-dim); padding-bottom: 10px; }
        .card-desc { font-size: 0.95rem; color: #eee; line-height: 1.5; text-align: justify; }

        @keyframes flicker { 0% { transform: scale(1); } 100% { transform: scale(1.05); } }
        @keyframes glitch-in { 0% { transform: scale(0.9); opacity: 0; } 100% { transform: scale(1); opacity: 1; } }

        .ar { grid-area: ar; } .terra { grid-area: terra; }
        .fogo { grid-area: fogo; } .agua { grid-area: agua; }
    </style>
</head>
<body>

    <div id="ui-wrapper">
        <header>:: OPUS MACHINA ::</header>

        <div class="altar-grid">
            <button class="node ar" onclick="toggleElement(this, 'AR')">
                <div class="symbol"></div>
                <b>AR</b><small>INTELECTO</small>
            </button>
            <button class="node agua" onclick="toggleElement(this, 'AGUA')">
                <div class="symbol"></div>
                <b>ÁGUA</b><small>EMOÇÃO</small>
            </button>
            <div class="vela-container" id="candle">
                <div class="flame"></div>
                <div class="candle-base"></div>
            </div>
            <button class="node terra" onclick="toggleElement(this, 'TERRA')">
                <div class="symbol"></div>
                <b>TERRA</b><small>MATÉRIA</small>
            </button>
            <button class="node fogo" onclick="toggleElement(this, 'FOGO')">
                <div class="symbol"></div>
                <b>FOGO</b><small>ENERGIA</small>
            </button>
        </div>

        <div id="status-log">AGUARDANDO CONEXÃO ELEMENTAR...</div>
        <button id="divine-btn" onclick="initRitual()">[ INICIAR CONSULTA ]</button>
    </div>

    <div id="card-modal">
        <div id="ritual-steps">
            <p id="instruction-text">RESPIRE E MENTALIZE SUA PERGUNTA...</p>
            <div id="mentalize-timer"><div id="timer-bar"></div></div>
            <p id="sub-instruction" style="font-size: 0.65rem; opacity: 0.6; letter-spacing: 3px; font-weight: bold;">SINTONIZANDO INTENÇÃO ORACULAR</p>
        </div>

        <div class="card-display" id="card-result">
            <small style="letter-spacing: 3px; opacity: 0.7;">RESPOSTA DO SISTEMA</small>
            <div class="card-title" id="oracle-title">...</div>
            <p class="card-desc" id="oracle-desc">...</p>
            <button onclick="closeOracle()" style="background:transparent; color:var(--amber-dim); border:none; cursor:pointer; margin-top:20px; font-family:inherit; letter-spacing: 1px;">[ FINALIZAR SESSÃO ]</button>
        </div>
    </div>

    <script>
        const activeNodes = new Set();
        const log = document.getElementById('status-log');
        const candle = document.getElementById('candle');
        const divineBtn = document.getElementById('divine-btn');
        
        const deckOriginal = [
            { t: "O MAGO", d: "A resposta está em suas mãos. Use as ferramentas disponíveis para codificar sua própria realidade." },
            { t: "A TORRE", d: "Sua pergunta aponta para algo que precisa ser demolido. Não tente consertar o que deve cair por obsolescência." },
            { t: "O EREMITA", d: "Retire-se para processar os dados. A resposta não virá do barulho externo, mas do seu núcleo central." },
            { t: "A ESTRELA", d: "Otimismo detectado. O caminho está limpo e o sinal é forte. Prossiga com fé na lógica do universo." },
            { t: "O LOUCO", d: "Sua pergunta requer um salto de fé. O risco de erro existe, mas a recompensa é o novo código de vida." },
            { t: "O DIABO", d: "Cuidado com a obsessão. Você está rodando em um loop de desejos que escravizam sua interface mental." },
            { t: "A MORTE", d: "O processo atual deve ser encerrado. Aceite o reboot total para que a nova versão possa carregar." },
            { t: "A LUA", d: "Sinal instável. Há muita interferência e ilusões na rede. Espere a poeira de dados baixar para decidir." }
        ];

        let currentDeck = [...deckOriginal];

        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        shuffle(currentDeck);

        function toggleElement(el, name) {
            el.classList.toggle('active');
            activeNodes.has(name) ? activeNodes.delete(name) : activeNodes.add(name);

            if (activeNodes.size === 4) {
                candle.classList.add('active');
                log.innerHTML = "ALTAR EM EQUILÍBRIO TOTAL.<br>CONEXÃO ORACULAR DISPONÍVEL.";
                divineBtn.style.display = "block";
            } else {
                candle.classList.remove('active');
                divineBtn.style.display = "none";
                log.innerHTML = activeNodes.size === 0 ? "AGUARDANDO CONEXÃO..." : "CALIBRANDO ELEMENTOS...";
            }
        }

        function initRitual() {
            document.getElementById('card-modal').style.display = 'flex';
            document.getElementById('ritual-steps').style.display = 'block';
            document.getElementById('card-result').style.display = 'none';
            
            const bar = document.getElementById('timer-bar');
            const text = document.getElementById('instruction-text');
            const sub = document.getElementById('sub-instruction');

            // Reset da barra
            bar.style.transition = "none";
            bar.style.transform = "translateX(-100%)";

            // Etapa 1: Mentalização (10 segundos)
            setTimeout(() => {
                text.innerText = "RESPIRE E MENTALIZE SUA PERGUNTA...";
                bar.style.transition = "transform 10s linear";
                bar.style.transform = "translateX(0%)";
            }, 100);

            setTimeout(() => {
                // Etapa 2: Processamento (2.5 segundos)
                text.innerText = "SINAL RECEBIDO. DECODIFICANDO...";
                sub.innerText = "EXTRAINDO ARQUÉTIPO DA REDE";
                bar.style.transition = "opacity 0.5s";
                bar.style.opacity = "0";
                
                setTimeout(() => {
                    showResult();
                }, 2500);

            }, 10100); // 10 segundos + delay inicial
        }

        function showResult() {
            if (currentDeck.length === 0) {
                currentDeck = [...deckOriginal];
                shuffle(currentDeck);
            }

            const card = currentDeck.pop();
            document.getElementById('ritual-steps').style.display = 'none';
            document.getElementById('card-result').style.display = 'block';
            document.getElementById('oracle-title').innerText = card.t;
            document.getElementById('oracle-desc').innerText = card.d;
            
            // Reset de opacidade da barra para a próxima vez
            document.getElementById('timer-bar').style.opacity = "1";
        }

        function closeOracle() {
            document.getElementById('card-modal').style.display = 'none';
            document.getElementById('timer-bar').style.transform = "translateX(-100%)";
        }
    </script>
</body>
</html>

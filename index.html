<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Opus Machina ‚à¥ 0.1</title>
<style>
body{
  background:#000;
  color:#eee;
  font-family:monospace;
  margin:0;
  padding:0 20px 20px;
  text-align:center;
}

header{
  padding:12px 0;
  font-size:20px;
  border-bottom:1px solid #333;
}

.altar{
  width:300px;
  height:300px;
  margin:20px auto;
  border:2px solid #555;
  background:#111;
  display:grid;
  grid-template-columns:1fr 1fr 1fr;
  grid-template-rows:1fr 1fr 1fr;
  align-items:center;
  justify-items:center;
  position:relative;
  transition:box-shadow 1.5s ease, opacity 1.5s ease;
  overflow:visible;
}

.altar.iniciado{
  box-shadow:0 0 35px gold;
  opacity:0.95;
}

.ar{grid-column:2;grid-row:1;}
.terra{grid-column:1;grid-row:2;}
.vela{grid-column:2;grid-row:2;}
.fogo{grid-column:3;grid-row:2;}
.agua{grid-column:2;grid-row:3;}

.elemento{
  font-size:32px;
  cursor:pointer;
  opacity:.5;
  transition:.3s;
}

.elemento.ativo{
  opacity:1;
  text-shadow:0 0 15px currentColor;
}

.ar.ativo{color:#fff}
.fogo.ativo{color:orange}
.agua.ativo{color:deepskyblue}
.terra.ativo{color:lime}

.vela{
  font-size:42px;
  cursor:pointer;
  transition:.3s;
  opacity:.5;
  z-index:2; /* para ficar acima das linhas */
  position:relative;
}

.vela.acesa{
  opacity:1;
  text-shadow:0 0 25px orange;
  transform:scale(1.2);
}

/* FA√çSCAS */
.faisca{
  position:absolute;
  animation:subir .8s ease-out forwards;
  font-size:22px;
  pointer-events:none;
}
@keyframes subir{
  to{transform:translateY(-30px);opacity:0;}
}

/* HALO */
.halo{
  position:absolute;
  width:140px;
  height:140px;
  border:2px solid gold;
  border-radius:50%;
  top:50%;
  left:50%;
  transform:translate(-50%,-50%) scale(0);
  animation:halo 1.2s ease forwards;
}
@keyframes halo{
  50%{transform:translate(-50%,-50%) scale(1.2);opacity:1;}
  100%{transform:translate(-50%,-50%) scale(1);opacity:0;}
}

.halo-fixo{
  position:absolute;
  width:180px;
  height:180px;
  border:2px solid gold;
  border-radius:50%;
  top:50%;
  left:50%;
  transform:translate(-50%,-50%);
  animation:respirar 3s infinite;
}
@keyframes respirar{
  50%{opacity:.3;transform:translate(-50%,-50%) scale(1.08);}
}

#mensagens div{margin-top:6px;font-weight:bold}
#mensagem{color:#ffd700}
#tempo{color:#ffd700}
#tarotInstrucao{color:hotpink}
#tarotCarta{color:cyan;opacity:0;transform:translateY(15px);transition:.8s}
#tarotCarta.show{opacity:1;transform:none}

.loading span{
  animation:pontos 1.2s infinite;
  opacity:0;
}
.loading span:nth-child(2){animation-delay:.2s}
.loading span:nth-child(3){animation-delay:.4s}
@keyframes pontos{50%{opacity:1}}

#joker{
  font-size:40px;
  animation:giro 1.2s linear infinite;
}
@keyframes giro{to{transform:rotate(360deg)}}

textarea{
  width:100%;
  height:40px;
  background:#111;
  color:#eee;
  border:1px solid #444;
  margin-top:15px;
}

button{
  width:100%;
  padding:12px;
  margin-top:10px;
  background:#111;
  color:#eee;
  border:2px solid #666;
}
button:active{transform:scale(.95)}

/* BARRA DE ENERGIA */
#barraEnergiaContainer{
  width:300px;
  height:20px;
  margin:20px auto 0;
  border:2px solid #555;
  background:#222;
  position:relative;
}
#barraEnergia{
  height:100%;
  width:100%;
  background:limegreen;
  transition: width 0.3s linear, background 0.3s linear;
}
#energiaTexto{
  position:absolute;
  width:100%;
  text-align:center;
  top:0;
  left:0;
  font-size:12px;
  line-height:20px;
  color:#000;
  font-weight:bold;
  pointer-events:none;
}

/* SVG TRA√áOS DE LUZ */
#energiaSVG{
  position:absolute;
  top:0;
  left:0;
  width:100%;
  height:100%;
  pointer-events:none;
  z-index:-1; /* fica atr√°s de elementos e vela */
}
.linhaEnergia{
  stroke:cyan;
  stroke-width:2;
  stroke-linecap:round;
  stroke-dasharray:8;
  opacity:0.2; /* quase transparente */
  animation:animLinha 1s linear infinite, pulsar 1.5s ease-in-out infinite;
}
@keyframes animLinha{
  to{stroke-dashoffset:16;}
}
@keyframes pulsar{
  0%,100%{opacity:0.15;}
  50%{opacity:0.35;}
}
</style>
</head>

<body>

<div id="modalIntro" style="
  position:fixed;
  top:0; left:0; width:100%; height:100%;
  background:rgba(0,0,0,0.95);
  color:#eee;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  font-family:monospace;
  font-size:16px;
  z-index:9999;
">
  <div style="text-align:center;">
    <div style="font-size:20px; font-weight:bold; color:#ffd700; margin-bottom:8px;">OPUS MACHINA ‚à¥ 0.1</div>
    <div style="font-size:12px; opacity:0.7; margin-bottom:12px;">
      Tecnomancia para Ritual Digital
      <br> Para uma experi√™ncia imersiva, acesse pelo smartphone.
      <br>
      <br> Projeto de <strong style="color:#ffd700;">Frater Makarios</strong>
    </div>
    <button id="entrarAltar" style="
      padding:10px 20px; 
      font-size:14px; 
      cursor:pointer; 
      background:#111; 
      color:#ffd700; 
      border:2px solid #ffd700;
    ">Entrar no Altar</button>
  </div>
</div>

<header>Opus Machina ‚à¥ 0.1</header>

<!-- BARRA DE ENERGIA -->
<div id="barraEnergiaContainer">
  <div id="barraEnergia"></div>
  <div id="energiaTexto">100 / 100</div>
</div>

<div class="altar" id="altar">
  <div class="elemento ar">üå¨Ô∏è</div>
  <div class="elemento terra">üå±</div>
  <div class="vela" id="vela">üïØÔ∏è</div>
  <div class="elemento fogo">üî•</div>
  <div class="elemento agua">üíß</div>
  <svg id="energiaSVG"></svg>
</div>

<div id="mensagens">
  <div id="mensagem"></div>
  <div id="tempo"></div>
  <div id="tarotInstrucao"></div>
  <div id="tarotCarta"></div>
</div>

<textarea id="intencao" placeholder="Digite sua inten√ß√£o..."></textarea>
<button id="selar">ATIVAR INTEN√á√ÉO</button>
<button id="lerTarot">LER TAROT</button>

<script>
// mesmo JS do seu c√≥digo original, nenhuma altera√ß√£o aqui
const altar=document.getElementById("altar");
const vela=document.getElementById("vela");
const elementos=document.querySelectorAll(".elemento");
const tempoEl=document.getElementById("tempo");
const mensagem=document.getElementById("mensagem");
const tarotInstrucao=document.getElementById("tarotInstrucao");
const tarotCarta=document.getElementById("tarotCarta");
const campo=document.getElementById("intencao");
const svgEnergia=document.getElementById("energiaSVG");

let tempo=0,timer=null,modoIniciado=false,holdTimer=null;
const vibrar=p=>navigator.vibrate&&navigator.vibrate(p);

let energia = 100;
const energiaMax = 100;

const barraEnergia = document.getElementById("barraEnergia");
const energiaTexto = document.getElementById("energiaTexto");

function atualizarBarraEnergia(){
  barraEnergia.style.width = (energia/energiaMax*100) + "%";
  if(energia>60) barraEnergia.style.background="limegreen";
  else if(energia>30) barraEnergia.style.background="gold";
  else barraEnergia.style.background="red";
  energiaTexto.innerText = `${energia} / ${energiaMax}`;
}

setInterval(()=>{
  if(energia<energiaMax){
    energia++;
    atualizarBarraEnergia();
  }
},1000);

atualizarBarraEnergia();

function faisca(x,y){
  const f=document.createElement("div");
  f.className="faisca";
  f.style.left=x+"px";
  f.style.top=y+"px";
  f.innerText="‚ú®";
  document.body.appendChild(f);
  setTimeout(()=>f.remove(),800);
}

let mensagemTimeout = null;

/* TRA√áOS DE LUZ */
function atualizarLinhasEnergia(){
  svgEnergia.innerHTML="";
  const ativos = Array.from(elementos).filter(e=>e.classList.contains("ativo"));
  for(let i=0;i<ativos.length;i++){
    for(let j=i+1;j<ativos.length;j++){
      const a=ativos[i].getBoundingClientRect();
      const b=ativos[j].getBoundingClientRect();
      const x1=a.left+a.width/2 - altar.getBoundingClientRect().left;
      const y1=a.top+a.height/2 - altar.getBoundingClientRect().top;
      const x2=b.left+b.width/2 - altar.getBoundingClientRect().left;
      const y2=b.top+b.height/2 - altar.getBoundingClientRect().top;
      const linha=document.createElementNS("http://www.w3.org/2000/svg","line");
      linha.setAttribute("x1",x1);
      linha.setAttribute("y1",y1);
      linha.setAttribute("x2",x2);
      linha.setAttribute("y2",y2);
      linha.classList.add("linhaEnergia");
      svgEnergia.appendChild(linha);
    }
  }
}

// restante do JS permanece igual
</script>

<footer style="
  margin-top:24px;
  padding:10px 0 6px;
  border-top:1px solid #222;
  font-family:monospace;
  font-size:11px;
  color:#777;
  text-align:center;
  letter-spacing:0.8px;
">
  <div>
    Projeto de <strong style="color:#ffd700;">Frater Makarios</strong>
  </div>
  <div style="margin-top:4px; font-size:10px; opacity:0.55;">
    Tecnomancia ¬∑ Ritual Digital ¬∑ Consci√™ncia Simb√≥lica
  </div>
  <div style="margin-top:6px; font-size:9px; opacity:0.4;">
    O s√≠mbolo responde √† aten√ß√£o ¬∑ A m√°quina apenas sustenta o rito
  </div>
</footer>

</body>
</html>
